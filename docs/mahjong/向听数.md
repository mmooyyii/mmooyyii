### 向听数计算

向听数就是差几张**有效进章**后能[听牌](https://baike.baidu.com/item/%E5%90%AC%E7%89%8C/11035712?fr=aladdin)  
当听牌时，向听数为0，胡牌时向听数是-1

向听数计算的公式是
```
N 手牌数 属于集合{2,5,8,11,14}
P 是否有雀头是为1，否为0
G 手牌中的完整顺子或者刻子数
g 手牌中的缺一张的顺子或者缺一张的刻子数
if g = 2 and p = 0:
    S = 2 * ((N - 2) / 3 -  G) - g - p + 1  
else: 
    S = 2 * ((N - 2) / 3 -  G) - g - p
```
[代码](https://github.com/mmooyyii/mmooyyii/blob/master/code/mahjong_bot.py)在这里可以找到

### 一个简单的麻将bot

#### 如何对13张牌
上述代码只能对14张牌的时候生效，如果要检测13张牌的时候，只需要加上一张与如何牌的距离都是无限大的牌即可。

#### 打出能使向听数减少的牌
摸牌后，遍历14张牌，去掉一张，用13张牌去检测向听数，找出能使向听数减少的牌，选择一张打出，即可在**有限的**回合数内胡牌

#### 最后是这个效果
```
牌: ['六条', '九筒', '八万', '发', '五条', '北', '白', '北', '一条', '八筒', '七筒', '七筒', '一万'] 
摸到 一万 
打出 一条 
牌: ['一万', '一万', '八万', '五条', '六条', '七筒', '七筒', '八筒', '九筒', '北', '北', '发', '白'] 
摸到 八筒 
打出 白 
牌: ['一万', '一万', '八万', '五条', '六条', '七筒', '七筒', '八筒', '八筒', '九筒', '北', '北', '发'] 
摸到 发 
打出 八万 
牌: ['一万', '一万', '五条', '六条', '七筒', '七筒', '八筒', '八筒', '九筒', '北', '北', '发', '发'] 
摸到 三条 
打出 六条 
牌: ['一万', '一万', '三条', '五条', '七筒', '七筒', '八筒', '八筒', '九筒', '北', '北', '发', '发'] 
摸到 一万 
打出 北 
牌: ['一万', '一万', '一万', '三条', '五条', '七筒', '七筒', '八筒', '八筒', '九筒', '北', '发', '发'] 
摸到 六筒 
听牌！['一万', '一万', '一万', '三条', '五条', '六筒', '七筒', '七筒', '八筒', '八筒', '九筒', '发', '发']
6巡听牌
```